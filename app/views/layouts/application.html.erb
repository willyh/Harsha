<!DOCTYPE html>
<html>
  <%= render 'shared/hide_url_bar' %>
  <%= stylesheet_link_tag :all %>
  <%= javascript_include_tag :defaults %>
  <%= csrf_meta_tag %>
  <%= stylesheet_link_tag 'blueprint/screen', :media => 'screen' %>
  <%= stylesheet_link_tag 'blueprint/print', :media => 'print' %>
  <%= stylesheet_link_tag 'print', :media => 'print' %>
  <%= stylesheet_link_tag 'custom', :media => 'screen' %>
  <meta name="viewport" content="width=700; user-scalable=0;"/>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

<head>
  <link rel="shortcut icon" href="/favicon.ico"/>
  <title><%= "MotoCafe | #{@head}" %></title>
  <div class="header"> <%= "#{@head}" %> </div>
</head>

<% flash.each do |key, value| %>
  <br />
  <div class="flash <%= key %>"><%= value %> ヽ(=^エ^=)ノ</div>
<% end %>
<%= yield %>
<body> 
<div class="navigation_bar">
	<div class="nav_item" onclick="location.href='<%=home_url%>';">
    Home
  </div>
<% unless admin? %>
	<div class="nav_item" onclick="location.href='<%=new_order_url%>';">
    Menu
  </div>
<% else %>
	<div class="nav_item" onclick="location.href='<%=menu_url%>';">
     Edit Menu
  </div>
<% end %>
</div>
</body>

<script type="text/javascript">
    var $stickyEl = $('#item-view');

    $(document).ready(function() {

      setStickyPosition();

      $(".item-info").hide();
        <% if @menu_item && @menu_item.id %>
          <%= "$('##{@menu_item.id}_info').show()" %>
        <% else %>
          <%= "$('.item-info').first().show();" %>
        <% end %>

      $(".category_selector").each(function() {
        hidden = $(this).parent().find('.new_category_field');
        $(this).val(hidden.find("#menu_item_category").val());
        if ($(this).val().length == 0) {
          hidden.show();
        }
        else {
          hidden.hide();
        }
      });
    });

      $(".item-name").mouseover(function() {
         $(".item-info").hide();
        var name = $(this).attr("id");
        name = name+"_info";

        var item = $("#"+name);
        item.show();
      });

      var $window = $(window);
      var elTop = $stickyEl.offset().top;

    function setStickyPosition() {
      var windowTop = $window.scrollTop();

      $stickyEl.toggleClass('sticky', windowTop > elTop);

      var right_pos = $("body").width();
      var left_pos = $("body").offset().left;
      $stickyEl.css('left',left_pos+right_pos-$stickyEl.outerWidth());
    }

    if( $stickyEl != null) {
      $(window).scroll(function() {
        setStickyPosition();
      });
      $('body').bind('touchmove', function() {
        setStickyPosition();
        if( windowTop < elTop ) {
        }
      });
    }
  </script>

</html>
