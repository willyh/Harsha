  <div class="item-names">
  <% form_for(@menu_item) do |f| %>
    <%= render 'shared/error_messages', :object => f.object %>
  <% end %>
  <div id='slider'>
    <ul>
      <h1>
        New Item
      </h1>
      <li id="new-item" class="item-name">
        New Item
      </li>
    <% @categories.each do |cat| %>
      <h1 id="c<%=cat.id%>">
        <%= text_field_tag :display_order, cat.display_order,
          {:onkeypress => "if(event.keyCode == 13)
                          $.ajax({
                            url:'#{change_order_category_url(cat)}',
                            data: 'display_order='+this.value,
                            datatype: 'script'
                          });",
          :style => "width:20px;"}
         %>
         <%=cat.name%>
       </h1>
        <% cat.menu_items.each do |item| %>
          <li id="<%= item.id %>" class="item-name">
            <%= text_field_tag :display_order, item.display_order,
              {:onkeypress => "if(event.keyCode == 13)
                              $.ajax({
                                url:'#{change_order_menu_item_url(item)}',
                                data: 'display_order='+this.value,
                                datatype: 'script'
                              });",
              :style => "width:20px;"}
             %>
            <%= item.name %>
          </li>
        <% end %>
    <% end %>
    </ul>
  </div>
</div>

<!-- floaty display -->

<div id="item-view" class="sticky floaty-box">
  <div class="new-item_info item-info scrollable">
      <% form_for(@new_item, :html => {:multipart => true}) do |f| %>

        <div class="frame">
          <h2>New Item</h2>
          Select a Category:
          <% options = {'New Category' => ''} %>
          <% @categories.each do |key| %>
            <% options[key.name] = key.name %>
          <% end %>
          <%= select_tag(:category_selector, options_for_select(options), :class => 'category_selector') %>
          <hidden class="new_category_field" >
          <%=f.text_field :category,:class => "field", :value=>@category.name %>
          </hidden>
            <div>
              <%= f.label "Photo:" %>
              <%= f.file_field :photo %>
            </div>
          <div><%=f.submit %></div>
        </div>
        <div class="description">
          <h2>
            <%= f.text_field :name, :class=>"field", :value=>@new_item.name %>
          </h2>
          $<%= f.text_field :price, :class=>"field", :value=>@new_item.price %>
          <%= f.text_area :description, :class=>"field", :style=>"height:27px;", :value=>@new_item.description %>
        </div>

      <% end %>
  </div>
    <% @categories.each do |cat| %>
      <% cat.menu_items.each do |item| %>
        <div class="<%= item.id%>_info item-info scrollable" style="cursor:default;">
          <% form_for(item, :html => {:multipart => true}) do |f| %>
          <%= render 'shared/error_messages', :object => f.object %>

            <div class="frame">
              <h2><%=item.name%></h2>
              Select a Category:
              <% options = {'New Category' => ''} %>
              <% @categories.each do |key| %>
                <% options[key.name] = key.name %>
              <% end %>
              <%= select_tag(:category_selector, options_for_select(options,cat.name), :class => 'category_selector') %>
              <hidden class="new_category_field" >
              <%=f.text_field :category, :class => "field", :value=>cat.name %>
              </hidden>
              <div>
                <div id="in_stock_<%=item.id%>" class="<%= item.out_of_stock ? "disabled" : "in_stock"%>"
                  onclick="$.ajax({url:'<%=toggle_stock_menu_item_url(item)%>',
                                    datatype: 'script'});">
                  In Stock
                </div>
                <div id="out_of_stock_<%=item.id%>" class="<%= item.out_of_stock ? "out_of_stock" : "disabled"%>"
                  onclick="$.ajax({url:'<%=toggle_stock_menu_item_url(item)%>',
                                    datatype: 'script'});">
                  Out of Stock
                </div>
              </div>
              <div>
                <%= f.label "Photo:" %>
                <%= f.file_field :photo %>
              </div>
              <div><%=f.submit%></div>
            </div>

            <div class="description">
              <h2>
                <%= f.text_field :name, :class=>"field", :value=>item.name %>
              </h2>
              $<%= f.text_field :price, :class=>"field", :value=>item.price %>
              <%= f.text_area :description, :class=>"field", :style=>"height:27px;", :value=>item.description %>
            </div>

        <% end %>
              <%=button_to "Delete", item, :method => :delete %>
        </div>
      <% end %>
    <% end %>
</div>

<!-- /floaty display -->

<script type="text/javascript">
  $("#new-item").mouseover(function() {
    $(".item-info").addClass('hidden');
    $(".new-item_info").removeClass('hidden');
  });

  $(".category_selector").change(function() {
      hidden = $(this).parent().find('.new_category_field');
      hidden.find("#menu_item_category").val($(this).val());
    if ($(this).val().length == 0) {
      hidden.show();
    }
    else {
      hidden.hide();
    }
  });
</script>
